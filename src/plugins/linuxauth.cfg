


[DEFAULT]
plugin_id=16071


[config]
type=detector
enable=yes
source=log
location=/var/log/auth.log


create_file=false
process=
start=no
stop=no
startup=/etc/init.d/dhcp3-server start
shutdown=/etc/init.d/dhcp3-server stop


[translation]
DHCPREQUEST=1
DHCPACK=2
DHCPOFFER=3
DHCPINFORM=4
DHCPRELEASE=5
DHCPDISCOVER=9
DHCPNAK=10
DHCPDECLINE=11
BOOTREQUEST=12
added reverse map=13
bound to=14
Sending=15
Listening=16



[0001 - SET/CHANGE_PASSWORD]
event_type=event
event_name=linux_auth_1
plugin_sid=linux_auth_1
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*passwd[^:]*: (?P<description>.*)"
device={$dst}
date={normalize_date($date)}
description={$description}
add_user=0


[0002 - command_with_sudo]
event_type=event
event_name=linux_auth_2
plugin_sid=linux_auth_2
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*sudo:\s(?P<user1>[^:\s]*)\s*:\s*TTY=(?P<terminal>[^\s;]*)\s*;\s*PWD=(?P<path>[^\s;]*)\s*;\s*USER=(?P<user>[^\s;]*)\s*;\s*COMMAND=(?P<command>.*)"
device={$dst}
date={normalize_date($date)}
user1={$user1}
terminal={$terminal}
path={$path}
user={$user}
command={$command}
add_user=0


[0003 - ssh_authentication_failure]
event_type=event
event_name=linux_auth_3
plugin_sid=linux_auth_3
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*sshd\[\d+\]\s*:\s.*authentication\s*failure\s*;\s*logname=(?P<logname>[^\s]*)\s*uid=(?P<uid>[^\s]*)\s*euid=(?P<euid>[^\s]*)\s*tty=(?P<tty>[^\s]*)\s*ruser=(?P<ruser>[^\s]*)\s*rhost=(?P<host>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s*user=(?P<user>.*)"
device={$dst}
date={normalize_date($date)}
logname={$logname}
uid={$uid}
euid={$euid}
tty={$tty}
ruser={$user}
host={$host}
user={$user}
add_user=1


[0004 - exit_session]
event_type=event
event_name=linux_auth_4
plugin_sid=linux_auth_4
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*su[^:]*:\s*.*session\s*closed\s*for\s*user\s*(?P<user>.*)"
device={$dst}
date={normalize_date($date)}
user={$user}
add_user=1


[0005 - close_session]
event_type=event
event_name=linux_auth_5
plugin_sid=linux_auth_5
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*(CRON|sshd)[^:]*:\s*.*session\s*closed\s*for\s*user\s*(?P<user>.*)"
device={$dst}
date={normalize_date($date)}
user={$user}
add_user=1


[0006 - start_session]
event_type=event
event_name=linux_auth_6
plugin_sid=linux_auth_6
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*(CRON|sshd)[^:]*:\s*.*session\s*opened\s*for\s*user\s*(?P<user>[^\s]*)\s.*"
device={$dst}
date={normalize_date($date)}
user={$user}
add_user=1


[0007 - login_failed]
event_type=event
event_name=linux_auth_7
plugin_sid=linux_auth_7
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*sshd[^:]*:\s*.*Failed\s*(?P<way>[^\s]*)\s*for\s*(?P<user>[^\s]*)\s*from\s*(?P<src_ip>[^\s]*)\s*port\s*(?P<src_port>[^\s]*).*"
device={$dst}
date={normalize_date($date)}
way={$way}
user={$user}
src_ip={$src_ip}
src_port={$src_port}
add_user=1


[0008 - login_success]
event_type=event
event_name=linux_auth_8
plugin_sid=linux_auth_8
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*sshd[^:]*:\s*.*Accepted\s*(?P<way>[^\s]*)\s*for\s*(?P<user>[^\s]*)\s*from\s*(?P<src_ip>[^\s]*)\s*port\s*(?P<src_port>[^\s]*).*"
device={$dst}
date={normalize_date($date)}
way={$way}
user={$user}
src_ip={$src_ip}
src_port={$src_port}
add_user=1


[0009 - attempt_change_user_login_failure]
event_type=event
event_name=linux_auth_9
plugin_sid=linux_auth_9
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+) su\[\d+\]\s*:\s.*authentication\s*failure\s*;\s*logname=(?P<logname>[^\s]*)\s*uid=(?P<uid>[^\s]*)\s*euid=(?P<euid>[^\s]*)\s*tty=(?P<tty>[^\s]*)\s*ruser=(?P<ruser>[^\s]*)\s*rhost=(?P<host>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|[^\s]*)\s*user=(?P<user>.*)"
device={$dst}
date={normalize_date($date)}
logname={$logname}
uid={$uid}
euid={$euid}
tty={$tty}
ruser={$ruser}
host={$host}
user={$user}
add_user=0


[0010 - try_change_user]
event_type=event
event_name=linux_auth_12
plugin_sid=linux_auth_12
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*su[^:]*:\s.*session\s*opened\s*for\s*user\s*(?P<user>[^\s]*)\s*by\s*(?P<user1>[^\s\(]+).*"
device={$dst}
date={normalize_date($date)}
user={$user}
user1={$user1}
add_user=0



[0011 - sudo_command_info]
event_type=event
event_name=linux_auth_11
plugin_sid=linux_auth_11
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*sudo[^:]*:\s*(?P<description>.*)"
device={$dst}
date={normalize_date($date)}
description={$description}
add_user=0



[0012 - su_command_info]
event_type=event
event_name=linux_auth_10
plugin_sid=linux_auth_10
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+) su\[\d+\]: (?P<description>.*)"
device={$dst}
date={normalize_date($date)}
description={$description}
add_user=0

[0013 - linux_ssh_service_info]
event_type=event
event_name=linux_auth_13
plugin_sid=linux_auth_13
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*sshd[^:]*:\s*(?P<description>.*)"
device={$dst}
date={normalize_date($date)}
description={$description}
add_user=0


[0014 - cron_process_info]
event_type=event
event_name=linux_auth_14
plugin_sid=linux_auth_14
regexp="(?i)(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<dst>\S+)\s*CRON[^:]*:\s*(?P<description>.*)"
device={$dst}
date={normalize_date($date)}
description={$description}
add_user=0















































